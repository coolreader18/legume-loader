(()=>{var e=document.currentScript.dataset.legumeEntry;function t(e,t){e=(()=>{let t=["github","npm"];for(let r=0;r<t.length;r++){let s=t[r];if(e.startsWith(`${s}:`)){return`https://cdn.jsdelivr.net/${s=="github"?"gh":s}/${e.replace(new RegExp(`${s}:`),"").trim()}`}}return e})().trim();let r;try{r=new URL(e)}catch(t){if(t.message=="Failed to construct 'URL': Invalid URL"){r=new URL(e,location.href)}}return fetch(r).then(e=>{if(e.ok){return e}else{throw new Error(t)}}).catch(alert)}var r={version:"v3.0.0",scripts:{},dir:{scripts:{update(){r.json(scriptdirurl).then(e=>{delete this.unloaded;return Object.assign(this,e)})},get(e){var t=this[e];return t.url.replace(/%VERSION/,t.latest)},unloaded:true},styles:{update(){r.json(styledirurl).then(e=>{delete this.unloaded;return Object.assign(this,e)})},get(e){var t=this[e];return t.url.replace(/%VERSION/,t.latest)},unloaded:true}},load(e,s){e=e.trim();if(typeof e=="string"){let t=["json","text"];for(let s=0;s<t.length;s++){let a=t[s];if(e.startsWith(`${a}:`)){return r[a](e.replace(new RegExp(`${a}:`),"").trim())}}}if(typeof s=="string"){switch(s){case"github":return r.github(e);case"script":return r.script(e);case"json":return r.json(e);case"text":return r.text(e);case"txtscript":return r.process(e);case"npm":return r.npm(e)}}if(typeof e=="string"){return t(e)}else if(Array.isArray(e)){e.forEach(t)}},async process(e,t){var a=s(e,t),n=a.metadata,i=a.code,l=(async()=>{if(!n.script){return}else{let t=n.script;for(var e=0;e<t.length;e++){await r.script(t[e])}return}})();if(n.style){n.style.forEach(r.style)}["var","async"].forEach(e=>{a[e]=a.metadata[e];delete a.metadata[e]});Object.assign(a.metadata,t);a.var=a.var||[];a.var=a.var.reduce((e,t)=>{var r=t.split(" ");e[r[0]]=r[1]||r[0];return e},{});var c={exports:{}},o=c.exports,u={module:c,exports:o};await l;if(a.legumescript&&a.metadata.name){let e=r.scripts[n.name]=r.scripts[n.name]||a;e.clicks=e.clicks+1||0;await new(a.async?Object.getProtoypeOf(async()=>{}).constructor:Function)(...Object.values(a.var),i).apply(e,Object.keys(a.var).map(e=>u[e]))}else{eval.call(null,i)}return!Object.getOwnPropertyNames(c.exports).length&&!Object.getOwnPropertySymbols(c.exports).length?undefined:c.exports},script(e){const s=e=>t(e,"Couldn't load the script.").then(e=>e.text()).then(r.process);if(e.startsWith("dir:")){e=e.replace(/dir:/,"").trim();return(async()=>r.dir.scripts.unloaded?await r.dir.scripts.update():r.dir.scripts)().then(t=>s(t.get(e)))}else{return s(e)}},style(e){const t=e=>{l.href=e;document.head.append(l)};l=document.createElement("link");l.rel="stylesheet";if(e.startsWith("dir:")){e=e.replace(/dir:/,"").trim();return(async()=>r.dir.styles.unloaded?await r.dir.styles.update():r.dir.styles)().then(r=>t(r.get(e)))}else{return t(e)}},github(e){return r.script(`https://cdn.jsdelivr.net/gh/${e}`)},json(e){return t(e,"Couldn't load JSON.").then(e=>e.json())},text(e){return t(e,"Couldn't load text.").then(e=>e.text())},npm(e){return t(`https://cdn.jsdelivr.net/npm/${e}`,"Couldn't load npm script.").then(e=>e.text()).then(r.process)}};window.Legume=r;if(e)r.load(e);function s(e,t){var r=false,s={cmt:/^(\s*\/\/\s*)/,multi:{start:/^(\s*\/\*\s*@legume\s*)/i,end:/^\s*\*\//},single:{start:/\s*@legume\s*/,match:/\s*@[^@]*/g}},a={name:"",version:"",description:"",repository:"",author:[],email:"",url:"",license:"",script:[],style:[],var:[],async:false},n={},i=[],l=[],c=false,o=e=>{var t=e.trim().match(/@([^\s]+)(?:\s+(.*))?$/);if(t){var r=t[1],s=t[2];if(r!==undefined){if(Array.isArray(a[r])){n[r]=n[r]||[];n[r].push(s)}else if(typeof a[r]=="boolean"){try{n[r]=JSON.parse(s)}catch(e){n[r]=true}}else{n[r]=s}}else{console.warn(`ignoring invalid metadata option: \`${r}\``)}}};e.match(/[^\r\n]+/g).forEach((e,t,a)=>{if(s.cmt.test(e)){var n=e.replace(s.cmt,"").trim();if(s.single.start.test(n)){n.replace(s.single.start,"");for(var u=s.single.match.exec(n);u;u=s.single.match.exec(n)){o(u[0])}}}else if(s.multi.end.test(e)&&r){r=false}else if(r){o(e)}else if(s.multi.start.test(e)){r=true;c=true}else{i.push(e)}if(r&&t+1==a.length){l.push("missing metdata block closing")}});return{metadata:Object.assign(n,t),code:i.join("\n"),errors:l.length?l:null,legumescript:c}}})();